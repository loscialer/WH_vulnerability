sel_order <- 
  cum_df %>% 
  filter(cum_imp == "Synergistic") %>% 
  arrange(Freq) %>% 
  mutate(com_th = factor(com_th))

cum_df <- cum_df %>% 
  mutate(cum_imp = ordered(cum_imp, levels = c('Antagonistic','Additive','Synergistic')))

fig10 <- cum_df %>% 
  mutate(com_th = factor(com_th, levels = sel_order$com_th, ordered = TRUE)) %>%  
  filter(!is.na(com_th), com_th != 'ht_ht',com_th != 'eu_eu',com_th != 'sf_sf') %>% 
  ggplot(aes(x = com_th, y = Freq, fill = cum_imp),  group = com_th) + 
  geom_bar(stat = 'identity', position = position_stack(), width = 0.7) +
  scale_y_continuous(name = 'Weighted counts', limits = c(0,50), expand = c(0,0)) +
  scale_fill_manual(name = 'Cumulative impact', breaks = c('Synergistic', 'Additive','Antagonistic' ), 
                    values = c('#F8766D','#00BA38','#619CFF') ) +
  scale_x_discrete(name = 'Stressor combinations', labels = c('OA - SF', 'IR - UW', 'OA - EU','OA - HSS','HY - UW', 'SF - IR', 'SF - SF',
                                                            'SF - UW', 'OA - HT', 'EU - EU', 'HSS - UW', 'IR - HSS', 'SF - EU','IR - EU', 
                                                            'SF - HSS','OA - IR', 'HY - IR', 'EU - UW', 'HY - SF', 'IR - HT', 'SF - HT', 
                                                            'HT - HT','HY - HSS', 'HY - EU', 'HY - HT', 'HSS - HT', 'EU - HT', 
                                                            'EU - HSS')) + 
  theme_pubr() + 
  coord_flip() +
  theme(axis.text.y = element_text(size = 10),
        axis.title.x = element_text(size = 12, face = 'bold'),
        axis.title.y = element_text(size = 12, face = 'bold'),
        legend.title = element_text(size = 12, face = 'bold'),
        axis.text.x = element_text(size = 10)) + 
  geom_rect(aes(ymin = 0, ymax = 46, xmin = 19.5, xmax = 25.5), color = 'black',fill = 'white', alpha = 0) + 
  annotate('text', x = 22, y = 47, label = '*', size = 12, colour = 'red') + 
  annotate('text', x = 9.5, y = 28, label = '*', size = 12, colour = 'blue')

